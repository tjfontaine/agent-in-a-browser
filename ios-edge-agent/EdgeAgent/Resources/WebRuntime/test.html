<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>iOS WASM Test</title>
    <style>
        body {
            font-family: system-ui;
            padding: 20px;
        }

        pre {
            background: #f5f5f5;
            padding: 10px;
            overflow: auto;
        }

        .success {
            color: green;
        }

        .error {
            color: red;
        }
    </style>
</head>

<body>
    <h1>iOS WASM Module Test</h1>
    <pre id="log"></pre>

    <script type="module">
        const log = document.getElementById('log');

        function addLog(msg, isError = false) {
            const line = document.createElement('div');
            line.textContent = new Date().toISOString().substr(11, 12) + ' ' + msg;
            line.className = isError ? 'error' : '';
            log.appendChild(line);
            console.log(msg);
        }

        async function test() {
            addLog('Starting module load test...');

            try {
                // Test 1: Load the main module (relative path)
                addLog('Loading web-headless-agent-ios.js...');
                const module = await import('./web-headless-agent/web-headless-agent-ios.js');
                addLog('✅ Module loaded successfully!', false);

                // Test 2: Check exports
                addLog('Checking exports...');
                const exports = Object.keys(module);
                addLog('Exports: ' + exports.join(', '));

                // Test 3: Try listProviders
                if (module.listProviders) {
                    addLog('Calling listProviders...');
                    const providers = module.listProviders();
                    addLog('Providers result: ' + JSON.stringify(providers));
                }

                addLog('✅ All tests passed!', false);

            } catch (error) {
                addLog('❌ Error: ' + error.message, true);
                addLog('Stack: ' + error.stack, true);
            }
        }

        test();
    </script>
</body>

</html>